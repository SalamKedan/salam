{#
| Variable         | Type    | Description                     |
|------------------|---------|---------------------------------|
| cart             | object  |                                 |
| cart.items_count | int     |                                 |
| cart.total       | string  | Formatted total ex: "١٠٠ ر.س"   |
#}
{% set important_links = theme.settings.get('important_links') %}
{% set header_is_sticky = theme.settings.get('header_is_sticky') %}

<header class="store-header">
  {# Top Nav - Minimalist Focus #}
  <div class="top-navbar bg-darker text-white py-2">
    <div class="container flex justify-end items-center">
        {# Language & Currency Switcher (Super User-Friendly) #}
        {% if store.settings.is_multilingual or store.settings.currencies_enabled %}
            <button type="button" 
                    onclick="salla.event.dispatch('localization::open')" 
                    class="flex items-center text-xs font-semibold uppercase opacity-90 hover:opacity-100 transition duration-200">
                
                {# Use simple text/flag for cleaner look #}
                <span class="flag iti__flag iti__{{ user.language.country_code }} rounded-sm mr-1 rtl:ml-1"></span>
                <span class="rtl:ml-1 ltr:mr-1">{{ user.language.code }}</span>
                <span class="text-gray-300 mx-1">|</span>
                <span>{{ currency.symbol }}</span>
            </button>
            <salla-localization-modal></salla-localization-modal>
        {% endif %}
    </div>
  </div>

  {# Main Nav - Sticky and Funky #}
  <div id="mainnav" 
       class="main-nav-container {{ header_is_sticky ? 'sticky top-0 z-50' : 'relative' }} shadow-default bg-white flex items-center">
      <div class="inner bg-inherit w-full">
          <div class="container">
              <div class="flex items-stretch justify-between relative">
                  <div class="flex items-center">
                      {# Mobile Menu Icon #}
                      <a class="lg:hidden mburger mburger--collapse leading-none rtl:ml-4 ltr:mr-4" href="#mobile-menu" aria-label="Open-menu">
                        <i class="sicon-menu text-primary text-2xl"></i>
                      </a>
                      
                      {# Store Logo #}
                      <a class="navbar-brand" href="{{ store.url }}">
                          <img fetchpriority="high" width="100%" height="100%" loading="eager" src="{{ store.logo }}" alt="{{ store.name }} logo">
                          {% if is_page('index') %}
                            <h1 class="sr-only">{{ store.name }}</h1>
                          {% else %}
                            <h2 class="sr-only">{{ store.name }}</h2>
                          {% endif %}
                      </a>
                      
                      {# DESKTOP NAVIGATION AREA (Our Icon Tabs Go Here) #}
                      {# NOTE: This is where we will implement the modern icon-tabs nav in a later step #}
                      <div class="hidden lg:flex items-stretch rtl:mr-10 ltr:ml-10">
                          {% include 'components/header/desktop-nav.twig' %}
                      </div>

                  </div>
                  
                  {# User Actions and Cart Summary #}
                  <div class="flex items-center justify-end my-2.5">
                      {# Search Button (moved to main nav for prominence) #}
                      <button class="header-btn" onclick="salla.event.dispatch('search::open')" aria-label="Search">
                          <i class="header-btn__icon sicon-search"></i>
                      </button>

                      {# User Account (Login/Avatar) #}
                      {% if user.type=='user' %}
                        <salla-user-menu avatar-only show-header></salla-user-menu>
                      {% else %}
                          <button class="header-btn" aria-label="user-icon" onclick="salla.event.dispatch('login::open')">
                            <i class="header-btn__icon sicon-user-circle"></i>
                          </button>
                      {% endif %}
                      
                      {# Cart Summary (Sky Blue Accent) #}
                      <salla-cart-summary class="ml-4 rtl:ml-[unset] rtl:mr-4 text-primary">
                        <i slot="icon" class="header-btn__icon icon sicon-shopping-bag"></i>
                      </salla-cart-summary>
                  </div>
              </div>
          </div>
      </div>
  </div>
</header>
<salla-search-modal></salla-search-modal>
{% if store.scope %}
    <salla-scopes selection="{{ store.scope.display_as == 'popup' ? 'mandatory' : 'optional' }}"></salla-scopes>
{% endif %}
